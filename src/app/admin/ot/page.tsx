'use client'
import { useEffect, useState } from 'react'
export default function AdminOT(){ const [date,setDate]=useState(new Date().toISOString().slice(0,10)); const [rows,setRows]=useState<any[]>([]); async function load(){ setRows(await fetch(`/api/admin/ot?date=${date}`).then(r=>r.json())) } useEffect(()=>{ load() },[]); async function approve(employee_id:number,work_date:string){ await fetch('/api/admin/ot/approve',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({employee_id,work_date})}); load() } return (<div style={{padding:24}}><h1>Overtime Approvals</h1><div style={{display:'flex',gap:8}}><input type='date' value={date} onChange={e=>setDate(e.target.value)}/><button onClick={load}>Load</button></div><table cellPadding={6} style={{marginTop:12}}><thead><tr><th>Emp</th><th>Date</th><th>OT R/W/H</th><th>SAR R/W/H</th><th>Total</th><th/></tr></thead><tbody>{rows.map((r:any)=> (<tr key={`${r.employee_id}-${r.work_date}`}><td>#{r.employee_id}</td><td>{r.work_date}</td><td>{r.ot_regular_minutes}/{r.ot_weekend_minutes}/{r.ot_holiday_minutes}</td><td>{Number(r.ot_regular_amount||0).toFixed(2)}/{Number(r.ot_weekend_amount||0).toFixed(2)}/{Number(r.ot_holiday_amount||0).toFixed(2)}</td><td>{(Number(r.ot_regular_amount||0)+Number(r.ot_weekend_amount||0)+Number(r.ot_holiday_amount||0)).toFixed(2)}</td><td><button onClick={()=>approve(r.employee_id,r.work_date)}>Approve</button></td></tr>))}</tbody></table></div>) }
